    <!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <link rel="apple-touch-icon" href="https://i.ibb.co/kVrdspsT/Barber-note-pro.jpg">
    <title>Barber Note Pro v.4</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
¬†   <style>
    :root { 
        --primary: #6366f1; --accent: #0ea5e9; --danger: #ef4444; --success: #22c55e; --bg: #f8fafc; --card: #ffffff; --text: #1e293b; --border: #e2e8f0; 
    }
    * { box-sizing: border-box; font-family: 'Kanit', sans-serif; -webkit-tap-highlight-color: transparent; }
    body { margin: 0; background: var(--bg); color: var(--text); padding-bottom: 90px; overflow-x: hidden; }
    .container { padding: 15px; max-width: 500px; margin: auto; }
    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡πâ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
    .grid-3 {
    display: grid;
    grid-template-columns: repeat(3, 1fr); 
    gap: 8px;
    margin-bottom: 15px;
    align-items: center;
}
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 25px; }
    .icon-card { 
        position: relative; 
        border-radius: 15px; 
        padding: 15px 5px; 
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        justify-content: center; 
        gap: 5px; 
        cursor: pointer; 
        box-shadow: 0 2px 4px rgba(0,0,0,0.05); 
        border: 1.5px solid transparent; 
        background: #fff;
    }
    .icon-card span:first-child { font-size: 22px; }
    .icon-card span:last-child { font-size: 11px; font-weight: 800; }

    /* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡πà‡∏≠‡∏á input/select ‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÉ‡∏´‡∏ç‡πà */
    input, select { 
        width: 100%; 
        height: 75px; /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á */
        padding: 10px; 
        border: 1.5px solid var(--border); 
        border-radius: 16px; 
        font-size: 20px; 
        font-weight: 800; 
        background: #f1f5f9; 
        outline: none; 
        text-align: center;
        color: var(--text);
    }

    input[type="date"], 
    input[type="time"],
    .grid-3 .icon-card {
    height: 55px !important; 
    border-radius: 12px !important;
    font-size: 16px !important;
    margin: 0 !important;
}
    /* ‡∏ä‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà */
    .price-box { 
        font-size: 70px; 
        font-weight: 600; 
        text-align: center; 
        color: #64748b; 
        padding: 20px; 
        border: 2.5px solid var(--primary); 
        border-radius: 25px; 
        margin-bottom: 30px; 
        width: 100%; 
        background: #fff; 
        display: flex;
        align-items: center;
        justify-content: center;
        height: 140px; 
    }
    .btn { border: none; padding: 12px; border-radius: 15px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-weight: 700; transition: 0.2s; }
    .btn:active { transform: scale(0.95); }
    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô */
    .btn-pay { 
        background: #e2e8f0; 
        color: #64748b; 
        border: 2px solid transparent; 
        height: 70px; 
        font-size: 18px; 
    }
    .btn-pay img, .btn-pay i { font-size: 24px; margin-right: 8px; }
    .btn-pay.active-cash { background: #dcfce7; color: #15803d; border-color: #22c55e; }
    .btn-pay.active-trans { background: #e0f2fe; color: #0369a1; border-color: #0ea5e9; }
    /* ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡∏ç‡πà‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
    .btn-main { 
        background: var(--primary); 
        color: white; 
        width: 100%; 
        height: 85px; 
        border-radius: 20px; 
        font-size: 35px; 
        margin-top: 10px;
    }
    .nav-bar{
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        height: 75px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÄ‡∏°‡∏ô‡∏π‡∏ö‡∏≤‡∏£‡πå */
        background: #ffffff;
        display: flex !important;
        flex-direction: row !important;
        justify-content: space-around;
        align-items: center;
        border-top: 1px solid #eee;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
        z-index: 1000;
    }

    .nav-item {
        flex: 1;
        display: flex !important;
        flex-direction: column !important;
        align-items: center;
        justify-content: center;
        gap: 4px;
        color: #94a3b8;
        text-decoration: none;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô */
    .nav-item i {
        font-size: 24px !important; 
    }
    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÉ‡∏ï‡πâ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô */
    .nav-item span {
        font-size: 13px !important;
        font-weight: 500;
    }

    .nav-item.active {
        color: #6366f1; /* ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á‡∏ï‡∏≤‡∏°‡∏ò‡∏µ‡∏° */
}
    /* ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ */
    .page { display: none; } .page.active { display: block; }
    .status-bar { padding: 12px; border-radius: 12px; text-align: center; font-weight: bold; margin-bottom: 10px; font-size: 14px; }
   .modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5); /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÅ‡∏™‡∏á */
    display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô */
    z-index: 2000; /* ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ Navbar */
    align-items: center;
    justify-content: center;
}

.modal-content {
    background: #fff;
    width: 90%;
    max-width: 400px;
    border-radius: 20px;
    padding: 20px;
    max-height: 85vh; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
    overflow-y: auto; /* ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏á‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏¢‡∏≠‡∏∞ */
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
}
</style>
    </head>
    <body>
  
<div class="container">
    <h2 id="shopNameDisp" style="text-align:center; color:var(--primary); margin: 10px 0;">Barber Shop</h2>
    <div id="p1" class="page active"> 
    <div class="grid-3">
    <div class="icon-card" style="background: #fffbeb; border-color: #fde68a;" onclick="handleInsurance()">
        <span>üõ°Ô∏è</span><span style="color: #b45309;">‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</span>
    </div>
    <div class="icon-card" style="background: #fff1f2; border-color: #fecdd3;" onclick="handleHoliday()">
        <span>üèñÔ∏è</span><span style="color: #be185d;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î</span>
    </div>
    <div class="icon-card" style="background: #f1f5f9; border-color: #cbd5e1;" onclick="openSettings()">
        <span>‚öôÔ∏è</span><span style="color: #475569;">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</span>
    </div>
</div>
    <div class="grid-3">
        <div class="icon-card" style="background: #f1f5f9; border-color: #cbd5e1; padding: 5px; height: 50px;">
        <span id="dateDisplay" style="font-size: 12px; font-weight: 700;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span>
        <input type="date" id="dateInp" onchange="updateDateDisplay(this.value)" style="position: absolute; opacity: 0; width: 100%; height: 100%; cursor: pointer;">
    </div>
        <input type="time" id="tStart" placeholder="‡πÄ‡∏£‡∏¥‡πà‡∏°" style="text-align:center; height: 50px;">
        <input type="time" id="tEnd" placeholder="‡πÄ‡∏™‡∏£‡πá‡∏à" style="text-align:center; height: 50px;">
    </div>
        <div style="display: grid; grid-template-columns: 1.2fr 1fr 1fr; gap: 8px; margin-bottom: 12px;"><select id="hairStyle" style="height: 50px;">
        <option value="">üíá ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏£‡∏á‡∏ú‡∏°</option>
        <option value="‡πÄ‡∏î‡πá‡∏Å">üë∂ ‡∏ï‡∏±‡∏î‡∏ú‡∏°‡πÄ‡∏î‡πá‡∏Å</option>
        <option>‡∏£‡∏≠‡∏á‡∏ó‡∏£‡∏á</option><option>‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</option><option>‡∏™‡∏Å‡∏¥‡∏ô‡πÄ‡∏ü‡∏î</option><option>‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡πâ‡∏≤‡∏á</option><option>‡∏ï‡∏≥‡∏£‡∏ß‡∏à/‡∏ó‡∏´‡∏≤‡∏£</option><option>‡∏ó‡∏£‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
        <option>‡πÅ‡∏Å‡πâ‡∏ú‡∏°</option><option>‡πÇ‡∏Å‡∏ô‡∏ú‡∏°</option></select>
        <select id="extra1" style="height: 50px;"><option value="">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ 1</option><option>‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î</option><option>‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤</option><option>‡∏™‡∏£‡∏∞‡∏ú‡∏°</option><option>‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°</option> </select>
        <select id="extra2" style="height: 50px;"><option value="">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ 2</option><option>‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î</option><option>‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤</option><option>‡∏™‡∏£‡∏∞‡∏ú‡∏°</option><option>‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°</option></select>
        </div>
        <input type="number" id="priceInp" class="price-box" placeholder="0" inputmode="numeric">
    <div class="grid-2">
        <button id="btnCash" class="btn btn-pay" onclick="selectPay('Cash')">üíµ ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</button>
        <button id="btnTrans" class="btn btn-pay" onclick="selectPay('Trans')">üì± ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</button>
    </div>
        <button id="mainSaveBtn" class="btn btn-main" onclick="handleSave()"><i class="fas fa-save"></i></button>
    </div>

    <div id="p2" class="page">
        <div class="grid-2"><div class="card" style="text-align: center;">
                <label style="font-size: 13px; opacity: 0.8;">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</label>
                <div id="dTotal" style="font-size:32px; font-weight:800; color:var(--primary);">0</div>
                <div id="dCounts" style="font-size:14px; font-weight:600; color:#64748b; margin-top:5px;">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: 0 ‡∏Ñ‡∏ô</div>
            </div>
            <div class="card" style="display: flex; flex-direction: column; justify-content: center; gap: 5px;">
                <div style="font-size:15px; font-weight:600;">üì± ‡πÇ‡∏≠‡∏ô: <b id="dTrans" style="color:#0284c7">0</b></div>
                <div style="font-size:15px; font-weight:600;">ü§µ ‡∏ä‡πà‡∏≤‡∏á: <b id="dBarber" style="color:var(--accent)">0</b></div>
                <div style="font-size:15px; font-weight:600;">üè† ‡∏£‡πâ‡∏≤‡∏ô: <b id="dShop" style="color:var(--warning)">0</b></div>
            </div>
        </div>
        <div id="settleBar" class="status-bar status-indigo">‡∏¢‡∏≠‡∏î‡∏û‡∏≠‡∏î‡∏µ</div>
        <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                <label style="font-weight: 600;">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</label>
                <button onclick="shareLine()" style="background:#06C755; color:white; border:none; padding:8px 12px; border-radius:8px; font-size:12px;"><i class="fab fa-line"></i> ‡∏™‡πà‡∏á LINE</button>
            </div>
            <div id="dailyList"></div>
        </div>
        <button onclick="go(3)" style="position: fixed; bottom: 90px; right: 20px; width: 60px; height: 60px; border-radius: 50%; background: var(--primary); color: white; border: none; box-shadow: 0 4px 15px rgba(0,0,0,0.2); font-size: 24px;">
            <i class="fas fa-check-circle"></i>
        </button>
    </div>

    <div id="p3" class="page">
        <div class="acc-main-card">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3 style="margin:0; font-size:16px; color:#b45309;"><i class="fas fa-wallet"></i> ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</h3>
                <div id="accLight" style="background:gray; width:12px; height:12px; border-radius:50%;"></div>
            </div>
            <div style="font-size:13px; color:#64748b; margin:15px 0; background:rgba(0,0,0,0.03); padding:12px; border-radius:15px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:5px;"><span>‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏°:</span><b id="accOldVal">‡∏ø0</b></div>
                <div style="display:flex; justify-content:space-between;"><span>‡∏¢‡∏≠‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ:</span><b id="accTodayVal" style="color:var(--primary)">‡∏ø0</b></div>
            </div>
            <div style="text-align:center; margin:20px 0;">
                <div style="font-size:14px; opacity:0.6;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</div>
                <div style="font-size:48px; font-weight:900; color:var(--primary);">‡∏ø<span id="accNet">0</span></div>
            </div>
            <div id="accStatus" class="status-bar">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
            <button class="btn" onclick="toggleAccHistory()" style="width:100%; border:1px dashed var(--primary); background:#f0f7ff; color:var(--primary); margin-bottom:15px;">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÄ‡∏á‡∏¥‡∏ô</button>
            <div id="accHistoryWrapper" style="display:none; margin-bottom:15px;"><div id="accHistory" class="card" style="font-size:12px; max-height:150px; overflow:y:auto;"></div></div>
            <div style="background:#f8fafc; padding:15px; border-radius:20px; border:1px solid var(--border);">
                <input type="date" id="accDate" style="margin-bottom:10px;">
                <input type="text" id="accNote" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥" style="margin-bottom:10px;">
                <button class="btn-save" onclick="clearAccount()">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÄ‡∏á‡∏¥‡∏ô</button>
            </div>
        </div>
        <div class="card" style="margin-top:20px;">
            <label>üìÖ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</label>
            <input type="date" id="histDate" onchange="loadHistDaily()" style="margin:10px 0;">
            <div id="histDailyArea"></div>
        </div>
    </div>
<div id="modalSet" class="modal">
    <div class="modal-content">
        <h3 style="margin-top:0; color:var(--primary);">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h3> <label style="font-size:11px; font-weight:600;">‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô</label> <input id="setShop" style="margin-bottom:10px;">
        <div class="grid-2">
            <div>
                <label style="font-size:11px; font-weight:600;">% ‡∏ä‡πà‡∏≤‡∏á</label><input type="number" id="setPerc" placeholder="‡πÄ‡∏ä‡πà‡∏ô 50"></div>
            <div>
                <label style="font-size:11px; font-weight:600;">‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô/‡∏ß‡∏±‡∏ô</label> <input type="number" id="setGuar" placeholder="0"></div>
        </div>
        
        <div style="margin-top:10px">
            <label style="font-size:11px; font-weight:600;">‡∏ò‡∏µ‡∏°‡πÅ‡∏≠‡∏õ</label>
            <select id="setTheme">
                <option value="neon-light">üå§ Neon Light (Default)</option> <option value="deep-navy">üåå Deep Navy</option> <option value="barber-dark">üåë Barber Dark</option> </select>
        </div>
        <div class="grid-2" style="margin-top:10px">
            <div>
                <label style="font-size:11px; font-weight:600;">‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á</label> <select id="setSound"> <option value="on">üîä ‡πÄ‡∏õ‡∏¥‡∏î</option> <option value="off">üîá ‡∏õ‡∏¥‡∏î</option></select>
            </div>
            <div>
                <label style="font-size:11px; font-weight:600;">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏π‡∏î</label><select id="setVoice"> <option value="female">üë© ‡∏´‡∏ç‡∏¥‡∏á</option> <option value="male">üë® ‡∏ä‡∏≤‡∏¢</option></select>
            </div>
        </div>
        <div class="grid-2" style="margin-top:20px">
            <button class="btn" style="background:var(--primary); color:#fff" onclick="saveSettings()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button><button class="btn" style="background:#e2e8f0; color:var(--text)" onclick="closeSettings()">‡∏õ‡∏¥‡∏î</button>
        </div>
         <button class="btn" style="width:100%; background:var(--danger); color:#fff; margin-top:10px; font-size:12px;" onclick="clearAllData()">‚ö†Ô∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>
</div>
    <nav class="nav-bar">
        <div class="nav-item active" id="n1" onclick="go(1)"><i class="fas fa-edit"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</div>
        <div class="nav-item" id="n2" onclick="go(2)"><i class="fas fa-file-invoice"></i>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>
        <div class="nav-item" id="n3" onclick="go(3)"><i class="fas fa-wallet"></i>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</div>
    </nav>
</div>

<script>
    let db = JSON.parse(localStorage.getItem("barber_db")) || [];
    let conf = JSON.parse(localStorage.getItem("barber_conf")) || { shop: "Barber Shop", perc: 50, guar: 0 };
    let account = JSON.parse(localStorage.getItem("barber_account")) || { balance: 0, logs: [] };
    let payMethod = "";

    const $ = (id) => document.getElementById(id);

    window.onload = () => {
        const today = new Date().toISOString().split('T')[0];
        $("dateInp").value = today;
        $("accDate").value = today;
        $("histDate").value = today;
        updateDateDisplay(today);
    };

    function go(n) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        $(`p${n}`).classList.add('active');
        $(`n${n}`).classList.add('active');
        renderDay();
    }
    function handleInsurance() {
    const today = document.getElementById('dateInp').value;
    const guaranteeAmount = parseInt(db.settings.guar) || 0; // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏ß‡πâ

    if (guaranteeAmount <= 0) {
        alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏¢‡∏≠‡∏î‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π '‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö' ‡∏Å‡πà‡∏≠‡∏ô");
        return;
    }
    // ‡∏Å‡∏£‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    const todayRecords = db.records.filter(r => r.date === today);
    // ‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ä‡πà‡∏≤‡∏á (Barber Share) ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
    const totalBarberShare = todayRecords.reduce((sum, r) => sum + (r.barberShare || 0), 0);

    if (totalBarberShare < guaranteeAmount) {
        const diff = guaranteeAmount - totalBarberShare;
        alert(`üõ°Ô∏è ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${today}\n------------------------\n‡∏¢‡∏≠‡∏î‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏≥‡πÑ‡∏î‡πâ: ${totalBarberShare} ‡∏ö‡∏≤‡∏ó\n‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà: ${guaranteeAmount} ‡∏ö‡∏≤‡∏ó\n\n‚úÖ ‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≤‡∏á: ${diff} ‡∏ö‡∏≤‡∏ó`);
    } else {
        alert(`üõ°Ô∏è ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${today}\n------------------------\n‡∏¢‡∏≠‡∏î‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏≥‡πÑ‡∏î‡πâ: ${totalBarberShare} ‡∏ö‡∏≤‡∏ó\n(‡πÄ‡∏Å‡∏¥‡∏ô‡∏¢‡∏≠‡∏î‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô ${guaranteeAmount} ‡∏ö‡∏≤‡∏ó‡πÅ‡∏•‡πâ‡∏ß üéâ)`);
    }
}

// --- 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î ---
function handleHoliday() {
    const today = document.getElementById('dateInp').value;
    if (!today) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏ô");

    if (confirm(`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${today} ‡πÄ‡∏õ‡πá‡∏ô "‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î"?`)) {
        const holidayRecord = {
            id: Date.now(),
            date: today,
            style: "üèñÔ∏è ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î",
            price: 0,
            method: "N/A",
            barberShare: 0,
            shopShare: 0
        };
        db.records.push(holidayRecord);
        saveDB();
        alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
        updateReportPage(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    }
}
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
function saveSettings() {
    db.settings.shopName = document.getElementById('setShop').value || "Barber Shop";
    db.settings.perc = parseInt(document.getElementById('setPerc').value) || 50;
    db.settings.guar = parseInt(document.getElementById('setGuar').value) || 0;

    saveDB(); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á LocalStorage
    document.getElementById('shopNameDisp').innerText = db.settings.shopName;
    
    alert("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
    closeSettings(); // ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏•‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á)
function openSettings() {
    document.getElementById('setShop').value = db.settings.shopName;
    document.getElementById('setPerc').value = db.settings.perc;
    document.getElementById('setGuar').value = db.settings.guar;
    
    // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô class ‡πÉ‡∏´‡πâ active ‡∏´‡∏£‡∏∑‡∏≠ display: block)
    document.getElementById('modalSet').style.display = 'block'; 
}
    function closeSettings() {
        $("modalSet").style.display = "none";
    }


    function clearAllData() {
        if (confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡∏ñ‡∏≤‡∏ß‡∏£!")) {
            localStorage.clear();
            location.reload();
        }
    }
    function updateDateDisplay(val) {
        const d = new Date(val);
        $("dateDisplay").innerText = d.toLocaleDateString('th-TH', { day: 'numeric', month: 'short' });
        renderDay();
    }

    function selectPay(m) {
        payMethod = m;
        $("btnCash").className = `btn btn-pay ${m === 'Cash' ? 'active-cash' : ''}`;
        $("btnTrans").className = `btn btn-pay ${m === 'Trans' ? 'active-trans' : ''}`;
    }

    function handleSave() {
        const p = $("priceInp").value;
        if (!p || !payMethod) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô"); return; }
        const r = {
            id: Date.now(),
            date: $("dateInp").value,
            time: $("tStart").value || new Date().toLocaleTimeString('th-TH', {hour:'2-digit', minute:'2-digit'}),
            svcs: [$("hairStyle").value, $("extra1").value, $("extra2").value].filter(s => s),
            price: Number(p),
            pay: payMethod
        };
        db.push(r);
        localStorage.setItem("barber_db", JSON.stringify(db));
        $("priceInp").value = "";
        selectPay("");
        renderDay();
        alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚úÖ");
    }

    function renderDay() {
        const d = $("dateInp").value;
        const today = db.filter(r => r.date === d);
        let tot = 0, trans = 0, cash = 0, listHtml = "";

        today.forEach(r => {
            tot += r.price;
            r.pay === 'Trans' ? trans += r.price : cash += r.price;
            listHtml += `<div class="history-row">
                <span><b>${r.time}</b> | ${r.svcs.join('+')}</span>
                <span>‡∏ø${r.price} <i class="fas fa-trash" style="color:red; margin-left:10px" onclick="delRec(${r.id})"></i></span>
            </div>`;
        });

        const bEarn = Math.max(tot * (conf.perc / 100), conf.guar);
        const sEarn = tot - bEarn;
        const settle = cash - bEarn;

        if($("dTotal")) $("dTotal").innerText = tot.toLocaleString();
        if($("dTrans")) $("dTrans").innerText = trans.toLocaleString();
        if($("dBarber")) $("dBarber").innerText = Math.floor(bEarn).toLocaleString();
        if($("dShop")) $("dShop").innerText = Math.floor(sEarn).toLocaleString();
        if($("dCounts")) $("dCounts").innerText = `‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${today.length} ‡∏Ñ‡∏ô`;
        $("dailyList").innerHTML = listHtml || "<center style='opacity:0.3;padding:20px'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</center>";

        const net = (account.balance || 0) + settle;
        $("accOldVal").innerText = `‡∏ø${(account.balance || 0).toLocaleString()}`;
        $("accTodayVal").innerText = `‡∏ø${Math.floor(settle).toLocaleString()}`;
        $("accNet").innerText = Math.abs(net).toLocaleString();
        $("accLight").style.background = net > 0 ? "red" : net < 0 ? "blue" : "green";
        $("accStatus").innerText = net > 0 ? "üö© ‡∏ä‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡πâ‡∏≤‡∏ô" : net < 0 ? "üö© ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ä‡πà‡∏≤‡∏á" : "‚úÖ ‡∏¢‡∏≠‡∏î‡∏•‡∏á‡∏ï‡∏±‡∏ß";
        $("accStatus").className = "status-bar " + (net > 0 ? "status-red" : net < 0 ? "status-indigo" : "status-green");
    }

    function delRec(id) {
        if (confirm("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?")) {
            db = db.filter(r => r.id !== id);
            localStorage.setItem("barber_db", JSON.stringify(db));
            renderDay();
        }
    }

    function clearAccount() {
        const net = (account.balance || 0) + (Number($("accTodayVal").innerText.replace('‡∏ø','')) || 0);
        if (confirm(`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÄ‡∏á‡∏¥‡∏ô ‡∏ø${net} ?`)) {
            account.logs.unshift({ date: $("accDate").value, amount: net, note: $("accNote").value });
            account.balance = 0; 
            localStorage.setItem("barber_account", JSON.stringify(account));
            alert("‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏¢‡∏≠‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
            renderDay();
        }
    }

    function toggleAccHistory() {
        const w = $("accHistoryWrapper");
        w.style.display = w.style.display === "none" ? "block" : "none";
        $("accHistory").innerHTML = account.logs.map(l => `<div>${l.date}: ‡∏ø${l.amount} (${l.note})</div>`).join('') || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥";
    }

    function loadHistDaily() {
        const d = $("histDate").value;
        const data = db.filter(r => r.date === d);
        $("histDailyArea").innerHTML = data.map(r => `<div class="history-row">${r.time} - ${r.svcs.join('+')} <b>‡∏ø${r.price}</b></div>`).join('') || "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
    }
    
    function shareLine() {
        const msg = `üíà ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡πâ‡∏≤‡∏ô\n‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${$("dTotal").innerText}\n‡∏ä‡πà‡∏≤‡∏á: ${$("dBarber").innerText}\n‡∏£‡πâ‡∏≤‡∏ô: ${$("dShop").innerText}`;
        window.open(`https://line.me/R/msg/text/?${encodeURIComponent(msg)}`);
    }
</script>
</body>
</html>
